(function(){"use strict";var e={9975:function(e,t,n){var o=n(9242),a=n(3396);const r={class:"container"};function s(e,t,n,o,s,l){const c=(0,a.up)("NavBar"),i=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(c),(0,a._)("div",r,[(0,a.Wm)(i)])],64)}var l=n(7139);const c={class:"navbar"},i={class:"navbar_menu flex"},u={class:"cursor-pointer"},p=(0,a.Uk)("Home"),d={key:0,class:"flex"},f={class:"cursor-pointer"},g=(0,a.Uk)("Login"),v={class:"cursor-pointer"},h=(0,a.Uk)("Map"),m={class:"cursor-pointer"},w=(0,a.Uk)("Profile");function _(e,t,n,o,r,s){const _=(0,a.up)("router-link"),k=(0,a.up)("CloseIcon"),b=(0,a.up)("MenuIcon");return(0,a.wg)(),(0,a.iD)("nav",c,[(0,a._)("div",i,[(0,a._)("ul",{class:(0,l.C_)({navbar_menu_mobile:o.showMobMenu,navbar_menu_pc:!o.showMobMenu})},[(0,a._)("li",u,[(0,a.Wm)(_,{to:"/"},{default:(0,a.w5)((()=>[p])),_:1})]),o.user?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",d,[(0,a._)("li",f,[(0,a.Wm)(_,{to:"/login"},{default:(0,a.w5)((()=>[g])),_:1})])])),o.user?((0,a.wg)(),(0,a.iD)("div",{key:1,class:(0,l.C_)({flex:!o.showMobMenu})},[(0,a._)("li",v,[(0,a.Wm)(_,{to:"/map"},{default:(0,a.w5)((()=>[h])),_:1})]),(0,a._)("li",m,[(0,a.Wm)(_,{to:"/profile"},{default:(0,a.w5)((()=>[w])),_:1})]),(0,a._)("li",null,[(0,a._)("button",{onClick:t[0]||(t[0]=(...e)=>o.handleLogout&&o.handleLogout(...e)),class:"cursor-pointer"},"Logout")]),(0,a._)("li",null,[(0,a._)("span",null,"Hi, "+(0,l.zw)(o.user.name),1)])],2)):(0,a.kq)("",!0)],2),(0,a._)("div",{onClick:t[1]||(t[1]=(...e)=>o.toggleMenu&&o.toggleMenu(...e)),class:"navbar_hamburger"},[o.showMobMenu?((0,a.wg)(),(0,a.j4)(k,{key:0,class:"navbar_icon cursor-pointer"})):((0,a.wg)(),(0,a.j4)(b,{key:1,class:"navbar_icon cursor-pointer"}))])])])}var k=n(4870),b=n(65),y=n(2483);const D={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},C=(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"},null,-1),M=[C];function x(e,t){return(0,a.wg)(),(0,a.iD)("svg",D,M)}var I=n(89);const H={},U=(0,I.Z)(H,[["render",x]]);var j=U;const P={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},T=(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),L=[T];function R(e,t){return(0,a.wg)(),(0,a.iD)("svg",P,L)}const S={},z=(0,I.Z)(S,[["render",R]]);var Z=z,O=n(6265),$=n.n(O);const W="";$().create({baseURL:W});const B=$().create({baseURL:W,headers:{"Content-Type":"application/json","Access-Control-Allow-Credentials":!0},withCredentials:!0}),F=async()=>{try{const{data:e}=await B.get("api/auth/user");return e.user}catch(e){console.log(e)}},q=async()=>{try{const{data:e}=await B.get("api/auth/userfb");return e.fbinfo}catch(e){console.log(e)}},E=async()=>{try{return void await B.get("api/auth/logout")}catch(e){console.log(e)}},A=async()=>{try{return void await B.get("api/auth/unbind")}catch(e){console.log(e)}};var N={components:{MenuIcon:j,CloseIcon:Z},setup(){const e=(0,b.oR)(),t=(0,y.tv)(),n=(0,k.iH)(!1),o=async()=>{await E(),e.commit("setUser",null),t.push("/")},r=()=>{n.value=!n.value};return{user:(0,a.Fl)((()=>e.state.user)),showMobMenu:n,handleLogout:o,toggleMenu:r}}};const V=(0,I.Z)(N,[["render",_],["__scopeId","data-v-faad50e0"]]);var K=V,G={components:{NavBar:K}};const Y=(0,I.Z)(G,[["render",s],["__scopeId","data-v-2e1b55f2"]]);var J=Y;const Q=e=>((0,a.dD)("data-v-004b1c81"),e=e(),(0,a.Cn)(),e),X={class:"home flex"},ee=Q((()=>(0,a._)("h1",null,"新北市都市更新地點查詢",-1))),te=Q((()=>(0,a._)("h3",null,"(請先登入)",-1)));function ne(e,t,n,o,r,s){const l=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("div",X,[ee,(0,a.Wm)(l,{to:"/login"},{default:(0,a.w5)((()=>[te])),_:1})])}var oe={name:"HomeView",components:{}};const ae=(0,I.Z)(oe,[["render",ne],["__scopeId","data-v-004b1c81"]]);var re=ae;const se=e=>((0,a.dD)("data-v-da23927a"),e=e(),(0,a.Cn)(),e),le={class:"login flex"},ce=se((()=>(0,a._)("h1",null,"Login",-1))),ie=["href"];function ue(e,t,n,o,r,s){const c=(0,a.up)("ToastAlert");return(0,a.wg)(),(0,a.iD)("div",le,[ce,o.errorMsg?((0,a.wg)(),(0,a.j4)(c,{key:0},{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,l.zw)(o.errorMsg),1)])),_:1})):(0,a.kq)("",!0),(0,a._)("a",{class:"btn",href:o.href},"Google Login",8,ie)])}const pe={class:"toast-alert-container"},de={class:"toast-alert"};function fe(e,t){return(0,a.wg)(),(0,a.iD)("div",pe,[(0,a._)("div",de,[(0,a.WI)(e.$slots,"default",{},void 0,!0)])])}const ge={},ve=(0,I.Z)(ge,[["render",fe],["__scopeId","data-v-6075da4c"]]);var he=ve;function me(){const e="https://accounts.google.com/o/oauth2/v2/auth",t={redirect_uri:"https://oauth-maps-vue-app.herokuapp.com/api/auth/sessions/oauth/google",client_id:"431057118212-smdf2hdbkj9ra8g5cghi8envgbr9ptg2.apps.googleusercontent.com",access_type:"offline",response_type:"code",prompt:"consent",scope:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email"].join(" ")},n=new URLSearchParams(t);return`${e}?${n.toString()}`}var we=me,_e={components:{ToastAlert:he},setup(){const e=(0,y.yj)(),t=(0,k.iH)(we()),n=(0,k.iH)(e.query.errorMsg);return(0,a.m0)((()=>{setTimeout((()=>{n.value=null}),2e3)})),{href:t,errorMsg:n}}};const ke=(0,I.Z)(_e,[["render",ue],["__scopeId","data-v-da23927a"]]);var be=ke;const ye=e=>((0,a.dD)("data-v-efcf54ac"),e=e(),(0,a.Cn)(),e),De={class:"profile flex"},Ce=ye((()=>(0,a._)("h1",null,"Profile",-1))),Me={class:"profile_info flex"},xe=["src"],Ie=["href"],He={key:1,class:"profile_info flex"};function Ue(e,t,n,r,s,c){const i=(0,a.up)("ToastAlert");return(0,a.wg)(),(0,a.iD)("div",De,[Ce,r.errorMsg?((0,a.wg)(),(0,a.j4)(i,{key:0},{default:(0,a.w5)((()=>[(0,a._)("p",null,(0,l.zw)(r.errorMsg),1)])),_:1})):(0,a.kq)("",!0),(0,a._)("div",Me,[(0,a.wy)((0,a._)("img",{src:r.getFaceBookPicture(r.fbUserID),alt:"userpicture"},null,8,xe),[[o.F8,r.fbUserID]]),r.fbUserID?((0,a.wg)(),(0,a.iD)("button",{key:0,class:"btn",onClick:t[0]||(t[0]=(...e)=>r.handleUnbind&&r.handleUnbind(...e))}," Unbind Facebook ")):((0,a.wg)(),(0,a.iD)("a",{key:1,class:"btn",href:r.href},"Bind Facebook",8,Ie))]),r.user?((0,a.wg)(),(0,a.iD)("div",He,[(0,a._)("ul",null,[(0,a._)("li",null,"Gmail: "+(0,l.zw)(r.user.email),1),(0,a._)("li",null,"Google name: "+(0,l.zw)(r.user.name),1)])])):(0,a.kq)("",!0)])}function je(){const e="https://www.facebook.com/v4.0/dialog/oauth",t={redirect_uri:"https://oauth-maps-vue-app.herokuapp.com/api/auth/sessions/oauth/facebook",client_id:"591219129162188",auth_type:"rerequest",response_type:"code",display:"popup",scope:["email","public_profile"].join(",")},n=new URLSearchParams(t);return`${e}?${n.toString()}`}var Pe=je;function Te(e){return`https://graph.facebook.com/${e}/picture?type=large`}var Le=Te,Re={components:{ToastAlert:he},setup(){const e=(0,b.oR)(),t=(0,y.tv)(),n=(0,y.yj)(),o=(0,k.iH)(Pe()),r=(0,k.iH)(null),s=(0,k.iH)(n.query.errorMsg),l=async()=>{const e=await q();e&&(r.value=e.id)};l();const c=async()=>{await A(),t.push({name:"empty"})};return(0,a.m0)((()=>{setTimeout((()=>{s.value=null}),2e3)})),{user:(0,a.Fl)((()=>e.state.user)),fbUserID:r,href:o,errorMsg:s,handleUnbind:c,getFaceBookPicture:Le}}};const Se=(0,I.Z)(Re,[["render",Ue],["__scopeId","data-v-efcf54ac"]]);var ze=Se;const Ze=e=>((0,a.dD)("data-v-2dc28936"),e=e(),(0,a.Cn)(),e),Oe={class:"map flex"},$e=Ze((()=>(0,a._)("h1",null,"綁定Facebook以查看更多內容",-1))),We={class:"tracker"},Be=Ze((()=>(0,a._)("div",{id:"map"},null,-1))),Fe={class:"search",ref:"searchRef"};function qe(e,t,n,o,r,s){const l=(0,a.up)("router-link"),c=(0,a.up)("SearchInput"),i=(0,a.up)("Pagination"),u=(0,a.up)("SearchResult"),p=(0,a.up)("ScrollTopBtn");return(0,a.wg)(),(0,a.iD)("div",Oe,[o.fbUserID?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(l,{key:0,to:"/profile"},{default:(0,a.w5)((()=>[$e])),_:1})),(0,a._)("section",We,[Be,(0,a._)("div",Fe,[o.fbUserID?((0,a.wg)(),(0,a.j4)(c,{key:0,onHandleClick:o.searchByKeyword},null,8,["onHandleClick"])):(0,a.kq)("",!0),(0,a.Wm)(i,{dataList:o.filteredurbanRenewalData.length>0?o.filteredurbanRenewalData:o.urbanRenewalData,onHandleClick:o.getPaginatedData},null,8,["dataList","onHandleClick"])],512)]),(0,a.Wm)(u,{paginatedData:o.paginatedData,onHandleClick:o.createUsermarker},null,8,["paginatedData","onHandleClick"]),(0,a.Wm)(p,{onHandleClick:o.goToElement},null,8,["onHandleClick"])])}var Ee=n(3153),Ae=n.n(Ee);const Ne="https://asia-east2-botfat.cloudfunctions.net/project_controller",Ve=$().create({baseURL:Ne,headers:{"Content-Type":"application/json"}}),Ke=async()=>{try{const e={lat:24.993955,lng:121.504603,function:"xinbei_distance"},t=await Ve.post("/",e);return t.data.result}catch(e){console.log(e)}},Ge=async()=>{try{const e={directory:"tucheng.json",function:"xinbei_json"},t=await Ve.post("/",e);return t.data.result}catch(e){console.log(e)}},Ye={class:"searchzone"};function Je(e,t,n,r,s,l){const c=(0,a.up)("SearchIcon");return(0,a.wg)(),(0,a.iD)("div",Ye,[(0,a._)("form",{onSubmit:t[2]||(t[2]=(0,o.iM)((t=>e.$emit("handleClick",r.keyword)),["prevent"])),class:"flex"},[(0,a.wy)((0,a._)("input",{class:"search-input",type:"text",placeholder:"請輸入您要查詢的捷運站名","onUpdate:modelValue":t[0]||(t[0]=e=>r.keyword=e)},null,512),[[o.nr,r.keyword]]),(0,a._)("div",{class:"search-icon cursor-pointer",onClick:t[1]||(t[1]=t=>e.$emit("handleClick",r.keyword))},[(0,a.Wm)(c)])],32)])}const Qe={class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Xe=(0,a._)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 16l2.879-2.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242zM21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),et=[Xe];function tt(e,t){return(0,a.wg)(),(0,a.iD)("svg",Qe,et)}const nt={},ot=(0,I.Z)(nt,[["render",tt]]);var at=ot,rt={components:{SearchIcon:at},setup(){const e=(0,k.iH)("");return{keyword:e}}};const st=(0,I.Z)(rt,[["render",Je],["__scopeId","data-v-8080a438"]]);var lt=st;const ct={class:"searchresult"};function it(e,t,n,o,r,s){const l=(0,a.up)("SearchResultInfo");return(0,a.wg)(),(0,a.iD)("div",ct,[(0,a._)("ul",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.paginatedData,(t=>((0,a.wg)(),(0,a.iD)("li",{key:t.id},[(0,a.Wm)(l,{info:t,onClick:n=>e.$emit("handleClick",[t.latitude,t.longitude])},null,8,["info","onClick"])])))),128))])])}const ut=e=>((0,a.dD)("data-v-3abbcff2"),e=e(),(0,a.Cn)(),e),pt={class:"info flex cursor-pointer box-shadow"},dt={class:"info-item"},ft={class:"info-item flex distance"},gt=ut((()=>(0,a._)("span",null,"km",-1)));function vt(e,t,n,o,r,s){return(0,a.wg)(),(0,a.iD)("div",pt,[(0,a._)("div",dt,[(0,a._)("h3",null,(0,l.zw)(n.info.stop_name),1),(0,a._)("span",null,"【"+(0,l.zw)(n.info.latitude)+", "+(0,l.zw)(n.info.longitude)+"】",1)]),(0,a._)("div",ft,[(0,a._)("h3",null,(0,l.zw)(n.info.distance),1),gt])])}var ht={props:["info"]};const mt=(0,I.Z)(ht,[["render",vt],["__scopeId","data-v-3abbcff2"]]);var wt=mt,_t={props:["paginatedData"],components:{SearchResultInfo:wt}};const kt=(0,I.Z)(_t,[["render",it],["__scopeId","data-v-862af614"]]);var bt=kt;const yt={key:0,class:"pagination flex"},Dt={class:"flex pagination_page"},Ct=["onClick"];function Mt(e,t,n,o,r,s){return 0!==n.dataList.length?((0,a.wg)(),(0,a.iD)("div",yt,[(0,a._)("button",{onClick:t[0]||(t[0]=(...e)=>o.backPage&&o.backPage(...e))},"prev"),(0,a._)("div",Dt,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(Math.ceil(n.dataList.length/o.perPage),((e,t)=>((0,a.wg)(),(0,a.iD)("button",{key:e,onClick:()=>o.goToPage(e),class:(0,l.C_)({active:o.page===t+1})},(0,l.zw)(e),11,Ct)))),128))]),(0,a._)("button",{onClick:t[1]||(t[1]=(...e)=>o.nextPage&&o.nextPage(...e))},"next")])):(0,a.kq)("",!0)}var xt={props:["dataList"],setup(e,{emit:t}){let n=(0,k.iH)(1);const o=100,r=(0,a.Fl)((()=>e.dataList.slice((n.value-1)*o,n.value*o))),s=()=>{n.value<e.dataList.length/o&&(n.value+=1)},l=()=>{1!==n.value&&(n.value-=1)},c=e=>{n.value=e};return(0,a.m0)((()=>{t("handleClick",r.value)})),{perPage:o,page:n,nextPage:s,backPage:l,goToPage:c}}};const It=(0,I.Z)(xt,[["render",Mt],["__scopeId","data-v-3610870f"]]);var Ht=It;const Ut=e=>((0,a.dD)("data-v-54ea0979"),e=e(),(0,a.Cn)(),e),jt={class:"scrolltop-container"},Pt=Ut((()=>(0,a._)("div",{className:"scrolltop-btn_icon"},[(0,a._)("i",{className:"arrow-up"})],-1))),Tt=[Pt];function Lt(e,t){return(0,a.wg)(),(0,a.iD)("div",jt,[(0,a._)("div",{class:"scrolltop-btn",onClick:t[0]||(t[0]=t=>e.$emit("handleClick"))},Tt)])}const Rt={},St=(0,I.Z)(Rt,[["render",Lt],["__scopeId","data-v-54ea0979"]]);var zt=St,Zt={components:{SearchInput:lt,SearchResult:bt,Pagination:Ht,ScrollTopBtn:zt},setup(){const e=(0,b.oR)(),t=(0,k.iH)(null);let n,o=(0,k.iH)(null),r=(0,k.iH)([]),s=(0,k.iH)([]),l=(0,k.iH)([]),c=[24.972663,121.443671],i=17,u=null;(0,a.bv)((async()=>{try{n=Ae().map("map").setView(c,i),Ae().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"© OpenStreetMap",zoomControl:!0}).addTo(n),o.value&&v();const e=await Ke();r.value=e,f(r.value);const t=await Ge();d(t)}catch(e){console.log(e)}}));const p=async()=>{const e=await q();e&&(o.value=e.id)};p();const d=e=>{Ae().geoJSON(e,{onEachFeature:function(e,t){t.bindPopup(`<b>Name: </b>${e.properties.name}`)}}).addTo(n)},f=e=>{for(let t of e){const e=Ae().marker([t.latitude,t.longitude],{title:t.stop_name}).addTo(n);e.bindPopup(`<b>${t.latitude}, ${t.longitude}</b>`)}},g=e=>{m(t.value);try{s.value=r.value.filter((t=>t.stop_name.includes(e)))}catch(n){alert(n.message)}},v=async t=>{t&&(c=t,m()),null!==u&&n.removeLayer(u);const a=Ae().marker(c,{title:c}).addTo(n);u=a;const r=document.createElement("div"),s=new Image(100,100);s.src=Le(o.value),r.appendChild(s);const l=new Image(100,100);l.src=e.state.user?.picture,r.appendChild(l),a.bindTooltip(r,{permanent:!0}).openTooltip(),n.setView(c,i)},h=e=>{l.value=e,m(t.value)},m=e=>{let t=0;if(e){const n=e;t=n.offsetTop}window.scrollTo(0,t)};return{user:(0,a.Fl)((()=>e.state.user)),searchRef:t,fbUserID:o,urbanRenewalData:r,filteredurbanRenewalData:s,paginatedData:l,searchByKeyword:g,createUsermarker:v,goToElement:m,getPaginatedData:h}}};const Ot=(0,I.Z)(Zt,[["render",qe],["__scopeId","data-v-2dc28936"]]);var $t=Ot;const Wt={class:"empty"};function Bt(e,t,n,o,r,s){return(0,a.wg)(),(0,a.iD)("div",Wt)}var Ft={name:"EmptyView",components:{},created(){this.$router.go(-1)}};const qt=(0,I.Z)(Ft,[["render",Bt]]);var Et=qt;const At=(0,b.MT)({state:{user:null},mutations:{setUser(e,t){e.user=t?{...e.user,...t}:t}},actions:{},getters:{getUser(e){return e.user}},modules:{}});var Nt=At;const Vt=[{path:"/",name:"home",component:re},{path:"/login",name:"login",component:be,meta:{guest:!0}},{path:"/profile",name:"profile",component:ze},{path:"/map",name:"map",component:$t},{path:"/empty",name:"empty",component:Et}],Kt=(0,y.p7)({history:(0,y.PO)("/"),routes:Vt});Kt.beforeEach((async(e,t,n)=>{const o=e.matched.some((e=>e.meta.auth)),a=e.matched.some((e=>e.meta.guest)),r=await F();Nt.commit("setUser",r),o?r?n():n("/login"):a&&r?n("/"):n()}));var Gt=Kt;(0,o.ri)(J).use(Nt).use(Gt).mount("#app")}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,a,r){if(!o){var s=1/0;for(u=0;u<e.length;u++){o=e[u][0],a=e[u][1],r=e[u][2];for(var l=!0,c=0;c<o.length;c++)(!1&r||s>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(l=!1,r<s&&(s=r));if(l){e.splice(u--,1);var i=a();void 0!==i&&(t=i)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,a,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,r,s=o[0],l=o[1],c=o[2],i=0;if(s.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(c)var u=c(n)}for(t&&t(o);i<s.length;i++)r=s[i],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunkoauth_maps_client"]=self["webpackChunkoauth_maps_client"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(9975)}));o=n.O(o)})();
//# sourceMappingURL=app.f14cba41.js.map